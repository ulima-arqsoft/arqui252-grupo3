> [4. Decisiones Iniciales de Arquitectura](../../4.md) ‚Ä∫ [4.6. Listado Consolidado](../4.6.md) ‚Ä∫ [4.6.4. Mapeo entre elementos de Arquitectura](4.6.4.md)

# 4.6.4. Mapeo entre elementos de Arquitectura

---

## Decisi√≥n General 1
**T√≠tulo:**  
Asignaci√≥n de responsabilidades a capas y estructuras f√≠sicas del sistema

**Contexto:**  
El sistema **InnovaLogix Retail ERP** est√° dividido en frontend (React), backend (Node.js + Express) y base de datos (PostgreSQL).  
Cada m√≥dulo funcional ‚Äî**Ventas, Inventario, Compras, Reportes y CRM**‚Äî debe estar correctamente ubicado dentro de la arquitectura l√≥gica y f√≠sica del proyecto, de modo que su mantenimiento, pruebas y despliegue sean eficientes.  
Se requiere definir c√≥mo se mapean las responsabilidades de cada m√≥dulo en la estructura t√©cnica del ERP.

**Alternativas:**

- **Mapeo por capas y carpetas por dominio:**
  - Organizaci√≥n del backend por dominios (`/ventas`, `/inventario`, `/compras`, `/reportes`, `/crm`).
  - Separaci√≥n interna en `controllers`, `services`, `models`, `routes`.
  - Frontend estructurado en `pages`, `components`, `contexts` y `services` por m√≥dulo funcional.
  - Cada capa asume una responsabilidad clara (presentaci√≥n, negocio, acceso a datos).

- **Mapeo plano sin separaci√≥n l√≥gica clara:**
  - C√≥digo sin estructura modular ni divisi√≥n por capas.
  - Mayor rapidez inicial pero menor mantenibilidad y trazabilidad.

**Criterios de elecci√≥n:**
- Separaci√≥n de responsabilidades por m√≥dulo.  
- Claridad en el flujo de desarrollo y pruebas.  
- Escalabilidad y mantenibilidad del c√≥digo.  
- Preparaci√≥n para migrar m√≥dulos a microservicios en el futuro.  

**Decisi√≥n:**  
Se adopta un **mapeo estructurado por capas y dominios funcionales**, donde cada m√≥dulo tiene su espacio l√≥gico asignado y se organiza por controladores, servicios y modelos.

**Sustento:**  
Este enfoque garantiza trazabilidad entre requerimientos y c√≥digo, promueve la mantenibilidad y permite evolucionar hacia arquitecturas distribuidas sin redise√±ar desde cero.

---

## 01: M√≥dulo de Ventas
**Decisi√≥n 1**  
**T√≠tulo:**  
Mapeo entre componentes del sistema para gesti√≥n de ventas, comprobantes y pagos

**Contexto:**  
El m√≥dulo de Ventas gestiona las operaciones diarias, emisi√≥n de comprobantes (boletas/facturas) y control de pagos. Es fundamental definir la distribuci√≥n entre frontend, backend y base de datos para asegurar consistencia y rendimiento.

**Alternativas:**

- **Mapeo en capas con separaci√≥n de responsabilidades:**
  - `VentasController` gestiona las rutas y llamadas desde el frontend.  
  - `VentasService` procesa la l√≥gica de negocio (totales, descuentos, impuestos).  
  - `VentasModel` accede a la base de datos relacional con Sequelize.  
  - Frontend consume endpoints REST y presenta formularios POS.

- **Mapeo plano con toda la l√≥gica en rutas:**
  - L√≥gica de negocio y acceso a datos en un mismo archivo.
  - Dificulta mantenimiento y escalabilidad.

**Criterios de elecci√≥n:**  
Trazabilidad, mantenibilidad, consistencia transaccional y claridad del flujo.

**Decisi√≥n:**  
Se adopta un **mapeo por capas** con separaci√≥n estricta entre controlador, servicio y modelo, y consumo desde el frontend mediante API REST.

**Sustento:**  
Garantiza control sobre el flujo de venta, integridad con el inventario y permite auditar cada transacci√≥n.

---

## 02: M√≥dulo de Inventario
**Decisi√≥n 1**  
**T√≠tulo:**  
Asignaci√≥n de responsabilidades para control de stock, productos y movimientos (Kardex)

**Contexto:**  
El m√≥dulo de Inventario gestiona productos, variantes, ubicaciones y movimientos. Debe reflejar cada cambio proveniente de ventas o compras en tiempo real y mantener trazabilidad.

**Alternativas:**

- **Mapeo por dominio funcional con servicios espec√≠ficos:**
  - Controladores separados: `InventarioController`, `KardexController`.  
  - Servicios dedicados: `StockService`, `MovimientoService`.  
  - Modelos relacionales para `productos`, `variantes`, `stock`, `kardex`.

- **Mapeo plano:**
  - Actualizaci√≥n directa desde ventas o compras sin separaci√≥n de responsabilidades.

**Criterios de elecci√≥n:**  
Integridad de stock, escalabilidad modular y trazabilidad por ubicaci√≥n.

**Decisi√≥n:**  
Mapeo estructurado por dominio, donde cada entidad se gestiona desde su servicio y mantiene sincronizaci√≥n con ventas y compras.

**Sustento:**  
Evita duplicaci√≥n de l√≥gica, permite auditor√≠a completa y facilita proyecciones de inventario.

---

## 03: M√≥dulo de Compras
**Decisi√≥n 1**  
**T√≠tulo:**  
Mapeo entre √≥rdenes de compra, proveedores y actualizaci√≥n autom√°tica de inventario

**Contexto:**  
El m√≥dulo de Compras gestiona adquisiciones, registros de proveedores y entrada de productos al almac√©n. Debe integrarse con inventario y reportes de costos.

**Alternativas:**

- **Mapeo por capas y relaciones entre dominios:**
  - Controladores: `ComprasController`, `ProveedorController`.  
  - Servicios: `OrdenCompraService`, `RecepcionService`.  
  - Modelos: `compras`, `detalle_compra`, `proveedores`.  
  - Al confirmar una compra, el servicio comunica al `InventarioService`.

- **Mapeo acoplado:**  
  - Actualizaciones directas de stock desde compras sin capa intermedia.

**Criterios de elecci√≥n:**  
Reutilizaci√≥n, consistencia entre m√≥dulos y facilidad de auditor√≠a.

**Decisi√≥n:**  
Se adopta un **mapeo por capas** con interacci√≥n mediante servicios desacoplados entre Compras e Inventario.

**Sustento:**  
Optimiza la trazabilidad de entradas y costos, y permite gestionar proveedores sin alterar otros m√≥dulos.

---

## 04: M√≥dulo de Reportes
**Decisi√≥n 1**  
**T√≠tulo:**  
Asignaci√≥n de responsabilidades para generaci√≥n y consulta de reportes

**Contexto:**  
El m√≥dulo de Reportes consolida informaci√≥n de ventas, inventario y compras para generar indicadores operativos y financieros.

**Alternativas:**

- **Mapeo por capas con separaci√≥n anal√≠tica:**
  - `ReportesController` gestiona endpoints de consulta.  
  - `EstadisticasService` agrupa la l√≥gica anal√≠tica.  
  - Consultas SQL estructuradas o vistas (`vw_ventas_diarias`, `vw_ranking_productos`).  
  - Frontend consume datos y renderiza gr√°ficos interactivos.

- **Mapeo simple:**  
  - C√°lculos realizados directamente desde frontend.

**Criterios de elecci√≥n:**  
Rendimiento, consistencia y precisi√≥n anal√≠tica.

**Decisi√≥n:**  
Se adopta un **mapeo anal√≠tico estructurado** donde los c√°lculos se ejecutan en el backend y los resultados se visualizan en frontend.

**Sustento:**  
Reduce carga en el cliente, mantiene coherencia en los resultados y permite exportar datos consistentes a PDF/Excel.

---

## 05: M√≥dulo de CRM y Atenci√≥n al Cliente
**Decisi√≥n 1**  
**T√≠tulo:**  
Mapeo entre validaci√≥n de clientes, reclamos, puntos y control de fidelizaci√≥n

**Contexto:**  
El m√≥dulo CRM gestiona informaci√≥n de clientes, reclamos, encuestas y programas de puntos. Es necesario definir c√≥mo se organizan las responsabilidades en la arquitectura.

**Alternativas:**

- **Mapeo por capas y servicios especializados:**
  - Controladores: `ClientesController`, `ReclamosController`, `FidelizacionController`.  
  - Servicios: `CRMService`, `EncuestasService`, `MovPuntosService`.  
  - Modelos: `clientes`, `reclamos`, `encuestas`, `mov_puntos`.  
  - Integraci√≥n con `VentasService` para relacionar clientes con sus transacciones.

- **Mapeo plano:**  
  - L√≥gica dispersa o duplicada entre ventas y reclamos.

**Criterios de elecci√≥n:**  
Trazabilidad de clientes, segmentaci√≥n y consistencia postventa.

**Decisi√≥n:**  
Mapeo modular por capas, con servicios especializados para cada tipo de interacci√≥n con el cliente.

**Sustento:**  
Facilita la extensi√≥n de funciones (fidelizaci√≥n, encuestas, notificaciones) y mantiene la coherencia entre CRM y ventas.


[‚¨ÖÔ∏è Anterior](../4.6.3/4.6.3.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../4.6.5/4.6.5.md)