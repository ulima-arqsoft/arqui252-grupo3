> [4. Decisiones Iniciales de Arquitectura](../../4.md) ‚Ä∫ [4.6. Listado Consolidado](../4.6.md) ‚Ä∫ [4.6.2. Modelo de Coordinaci√≥n](4.6.2.md)

# 4.6.2. Modelo de Coordinaci√≥n

---

## Decisi√≥n General 1:
**T√≠tulo:**  
Coordinaci√≥n entre frontend y backend mediante API REST desacoplada

**Contexto:**  
**InnovaLogix Retail ERP** se desarrolla bajo una arquitectura cliente-servidor desacoplada, donde el frontend (React) y el backend (Node.js + Express) son desplegados de forma independiente en **Vercel** y **Render**.  
El sistema requiere una forma de comunicaci√≥n est√°ndar, segura y mantenible entre ambas capas, que permita manejar operaciones cr√≠ticas (ventas, inventario, compras, reportes, CRM) sin comprometer la independencia ni la escalabilidad del sistema.

**Alternativas:**
- **API REST (HTTP/JSON):**  
  - Est√°ndar actual para comunicaci√≥n entre cliente y servidor.  
  - Utiliza rutas y m√©todos HTTP bien definidos (GET, POST, PUT, DELETE).  
  - Facilita la integraci√≥n con frontend mediante fetch o Axios.  
  - Permite documentaci√≥n mediante Swagger o Postman.  
  - Ideal para sistemas modulares y desacoplados.
- **WebSockets o comunicaci√≥n en tiempo real:**  
  - Mantiene conexi√≥n bidireccional permanente.  
  - √ötil para operaciones en vivo (actualizaci√≥n de stock o dashboards en tiempo real).  
  - Requiere mayor complejidad de infraestructura y pruebas.  
  - No es esencial en la versi√≥n inicial del ERP.

**Criterios de elecci√≥n:**
- Simplicidad de desarrollo y despliegue.
- Compatibilidad con tecnolog√≠as modernas de frontend y backend.
- Seguridad y control de cada solicitud.
- Estandarizaci√≥n de comunicaci√≥n e integraci√≥n futura.

**Decisi√≥n:**  
Se adopta **API RESTful (HTTP/JSON)** como mecanismo principal de coordinaci√≥n entre frontend y backend.

**Sustento:**  
REST ofrece un modelo desacoplado, seguro y documentable. Permite que cada m√≥dulo (Ventas, Inventario, Compras, CRM, Reportes) se comunique mediante endpoints bien definidos y controlados.  
El sistema aplica **middleware de autenticaci√≥n JWT** en cada solicitud, garantizando trazabilidad, control de acceso y escalabilidad futura sin redise√±os globales.

---

## 01: M√≥dulo de Ventas R√°pidas
**Decisi√≥n 1:**  
**T√≠tulo:**  
Coordinaci√≥n del flujo de venta, comprobantes e inventario mediante API REST y eventos internos

**Contexto:**  
El m√≥dulo de Ventas R√°pidas gestiona el registro de transacciones, emisi√≥n de comprobantes y actualizaci√≥n del inventario. Es esencial definir c√≥mo se coordinar√°n las operaciones entre el punto de venta (frontend) y el backend del ERP.

**Alternativas:**
- **Coordinaci√≥n directa por API REST:**  
  - Cada venta se env√≠a al backend para su validaci√≥n, registro y emisi√≥n del comprobante.  
  - El backend actualiza el inventario y genera los reportes de venta.  
- **Modelo h√≠brido con eventos internos:**  
  - El frontend registra la venta v√≠a API REST.  
  - El backend emite un evento `VentaConfirmada`, que notifica al m√≥dulo de Inventario para actualizar stock autom√°ticamente.

**Criterios de elecci√≥n:**
- Rapidez de respuesta.
- Integridad y consistencia de datos.
- Sincronizaci√≥n entre m√≥dulos.
- Posibilidad de operaci√≥n offline.

**Decisi√≥n:**  
Se implementa **coordinaci√≥n por API REST complementada con eventos asincr√≥nicos internos** para sincronizar ventas e inventario.

**Sustento:**  
Permite transacciones r√°pidas y seguras, garantizando la actualizaci√≥n del inventario sin intervenci√≥n manual.  
Los eventos desacoplan la l√≥gica de ventas e inventario, favoreciendo la escalabilidad y la trazabilidad de las operaciones.

---

## 02: M√≥dulo de Inventario
**Decisi√≥n 1:**  
**T√≠tulo:**  
Sincronizaci√≥n autom√°tica de stock mediante eventos asincr√≥nicos entre m√≥dulos

**Contexto:**  
El m√≥dulo de Inventario requiere mantenerse sincronizado con los m√≥dulos de Ventas y Compras para reflejar el stock en tiempo real. La coordinaci√≥n entre m√≥dulos debe ser confiable, eficiente y con bajo acoplamiento.

**Alternativas:**
- **Coordinaci√≥n directa v√≠a API REST:**  
  - Los m√≥dulos de Ventas y Compras llaman directamente a los endpoints de Inventario.  
  - Requiere control de dependencias entre servicios.  
- **Eventos asincr√≥nicos internos:**  
  - Cada operaci√≥n relevante (venta o compra) emite un evento que el m√≥dulo de Inventario escucha y procesa.  
  - Desacopla los m√≥dulos y facilita la escalabilidad.

**Criterios de elecci√≥n:**
- Consistencia de los datos.
- Escalabilidad y bajo acoplamiento.
- Reducci√≥n de dependencias entre m√≥dulos.
- Facilidad de mantenimiento.

**Decisi√≥n:**  
Se adopta **comunicaci√≥n mediante eventos asincr√≥nicos internos** complementada con API REST para consultas.

**Sustento:**  
Los eventos `VentaConfirmada` y `CompraConfirmada` garantizan sincronizaci√≥n inmediata sin llamadas redundantes entre servicios.  
La API REST se mantiene para consultas, mientras que los eventos optimizan los procesos de actualizaci√≥n en segundo plano.

---

## 03: M√≥dulo de Compras
**Decisi√≥n 1:**  
**T√≠tulo:**  
Coordinaci√≥n entre √≥rdenes de compra e inventario mediante eventos de dominio

**Contexto:**  
El m√≥dulo de Compras debe registrar adquisiciones, actualizar el inventario y permitir el seguimiento de proveedores. Se requiere definir c√≥mo comunicar estas operaciones al resto del sistema.

**Alternativas:**
- **Invocaci√≥n directa al m√≥dulo de Inventario:**  
  - Cada compra confirmada llama al endpoint `/inventario/actualizar`.  
  - Requiere conocimiento directo de la estructura de Inventario.  
- **Emisi√≥n de eventos de dominio:**  
  - El backend emite un evento `CompraConfirmada` tras registrar una compra.  
  - El m√≥dulo de Inventario escucha y ajusta el stock autom√°ticamente.

**Criterios de elecci√≥n:**
- Trazabilidad de movimientos.
- Eficiencia y reducci√≥n de dependencias.
- Integridad de informaci√≥n entre m√≥dulos.

**Decisi√≥n:**  
Se implementa **coordinaci√≥n mediante eventos de dominio (CompraConfirmada)** complementada con endpoints REST para reportes y seguimiento.

**Sustento:**  
Los eventos reducen acoplamiento y aseguran coherencia de datos entre m√≥dulos, permitiendo que Inventario se actualice en tiempo real sin dependencias cruzadas.  
Adem√°s, esta estrategia facilita auditor√≠as y control de proveedores.

---

## 04: M√≥dulo de Reportes
**Decisi√≥n 1:**  
**T√≠tulo:**  
Generaci√≥n de reportes mediante agregaci√≥n de datos desde API REST centralizada

**Contexto:**  
El m√≥dulo de Reportes consolida informaci√≥n de Ventas, Compras e Inventario. Es necesario definir c√≥mo coordinar√° la recopilaci√≥n de datos y su presentaci√≥n.

**Alternativas:**
- **Consultas directas a la base de datos:**  
  - Acceso a m√∫ltiples tablas sin intermediaci√≥n.  
  - Riesgo de duplicar l√≥gica de negocio.  
- **Consumo de endpoints REST especializados:**  
  - Cada m√≥dulo expone endpoints de resumen (ej. `/ventas/diarias`, `/compras/mensuales`).  
  - Reportes centraliza y agrega datos.  

**Criterios de elecci√≥n:**
- Separaci√≥n de responsabilidades.
- Consistencia de los c√°lculos.
- Facilidad para auditor√≠a y mantenimiento.

**Decisi√≥n:**  
El m√≥dulo de Reportes coordina mediante **API REST especializada** para agregaci√≥n y visualizaci√≥n de datos.

**Sustento:**  
Los endpoints estandarizados facilitan la integraci√≥n con **exceljs** y **pdfmake**, asegurando que los reportes sean coherentes y exportables sin sobrecargar el cliente.

---

## 05: M√≥dulo de CRM y Atenci√≥n al Cliente
**Decisi√≥n 1:**  
**T√≠tulo:**  
Coordinaci√≥n del CRM con Ventas y Reportes mediante API REST y eventos de comportamiento

**Contexto:**  
El m√≥dulo CRM gestiona interacciones con clientes, programas de fidelizaci√≥n, reclamos y encuestas. Debe coordinarse con Ventas y Reportes para analizar comportamiento y satisfacci√≥n del cliente.

**Alternativas:**
- **Integraci√≥n directa entre m√≥dulos:**  
  - CRM consulta manualmente datos de ventas.  
  - Mayor acoplamiento y riesgo de inconsistencias.  
- **Eventos asincr√≥nicos complementados con API REST:**  
  - Ventas emite eventos (`VentaConfirmada`, `ReclamoCreado`).  
  - CRM los procesa y los combina con datos anal√≠ticos obtenidos v√≠a API REST.

**Criterios de elecci√≥n:**
- Sincronizaci√≥n en tiempo real.
- Reducci√≥n del acoplamiento.
- An√°lisis integrado de ventas y clientes.
- Capacidad de expansi√≥n.

**Decisi√≥n:**  
Se adopta un modelo **mixto**: CRM se coordina con otros m√≥dulos mediante **eventos asincr√≥nicos** y consulta datos consolidados a trav√©s de la **API REST**.

**Sustento:**  
Este enfoque permite automatizar la creaci√≥n de perfiles de clientes y generar m√©tricas de fidelizaci√≥n sin impactar el rendimiento del sistema principal.  
La comunicaci√≥n por eventos garantiza consistencia, mientras que la API REST asegura acceso estructurado y seguro a la informaci√≥n.

---

[‚¨ÖÔ∏è Anterior](../4.6.1/4.6.1.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../4.6.3/4.6.3.md)