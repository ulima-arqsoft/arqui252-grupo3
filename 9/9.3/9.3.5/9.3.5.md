> [9. Metodolog√≠a de Dise√±o de Arquitectura - Aplicaci√≥n de ADD](../../9.md) ‚Ä∫ [9.3. Iteraci√≥n 2: Identificar estructuras para soportar la funcionalidad primaria](../9.3.md) ‚Ä∫ [9.3.5. Vistas y Decisiones](9.3.5.md)

# 9.3.5. Vistas y Decisiones
<h1>9.3.5. Vistas y Decisiones</h1>

<p>
Esta secci√≥n analiza c√≥mo las decisiones tomadas en la Iteraci√≥n 2 satisfacen los requisitos funcionales y atributos de calidad relacionados con la 
<strong>funcionalidad primaria del sistema InnovaLogix Retail ERP</strong>, enfocada en:
<strong>Inventario, Kardex, Validaci√≥n de Stock, Integraci√≥n POS ‚Üî Inventory, Seguridad y Sincronizaci√≥n en Tiempo Real</strong>.
</p>

<hr>

<h2>1. Vista L√≥gica</h2>

<p>La vista l√≥gica describe c√≥mo los componentes y servicios colaboran para implementar la funcionalidad primaria.</p>

<ul>
  <li><strong>InventoryService</strong> como autoridad central del stock.</li>
  <li><strong>POSService</strong> como generador de eventos de venta.</li>
  <li><strong>KardexService</strong> como log inmutable de entradas y salidas.</li>
  <li><strong>CacheService</strong> para acelerar consultas de cat√°logo y stock.</li>
  <li><strong>AlertService</strong> para notificar stock bajo.</li>
  <li><strong>EventEmitter</strong> como bus interno de eventos.</li>
</ul>

<p><strong>Decisiones clave asociadas:</strong> DEC-1, DEC-2, DEC-3, DEC-8</p>

<hr>

<h2>2. Vista de Procesos</h2>

<p>Describe c√≥mo se coordinan los componentes durante operaciones cr√≠ticas como ventas, ajustes e ingresos de mercader√≠a.</p>

<h3>Flujo: Venta con validaci√≥n y actualizaci√≥n de stock</h3>

<ol>
  <li>POS solicita <code>/inventory/validate</code> para confirmar disponibilidad.</li>
  <li>Inventory aplica validaci√≥n con cache y DB.</li>
  <li>Si hay stock, POS crea la venta (<code>POST /sales</code>).</li>
  <li>POS emite evento <strong>SaleCompleted</strong>.</li>
  <li>Inventory recibe el evento, abre transacci√≥n con <code>SELECT ... FOR UPDATE</code>.</li>
  <li>Decrementa el stock y registra Kardex.</li>
  <li>Emite <code>StockUpdated</code> v√≠a WebSocket.</li>
</ol>

<p><strong>Decisiones clave asociadas:</strong> DEC-1, DEC-4, DEC-6, DEC-10</p>

<hr>

<h2>3. Vista de Datos</h2>

<p>Representa las estructuras que soportan inventario, kardex y ventas.</p>

<ul>
  <li><strong>Tabla Producto</strong> ‚Äì Cat√°logo base.</li>
  <li><strong>Tabla Variante (SKU)</strong> ‚Äì Identificador √∫nico de stock.</li>
  <li><strong>Tabla Stock</strong> ‚Äì Cantidad, stock m√≠nimo, ubicaci√≥n.</li>
  <li><strong>Tabla Kardex</strong> ‚Äì Movimientos inmutables.</li>
  <li><strong>Tabla Venta / DetalleVenta</strong> ‚Äì Para eventos de venta.</li>
</ul>

<p><strong>Optimizaciones aplicadas:</strong></p>

<pre><code>CREATE INDEX idx_sku ON variantes(sku);
CREATE INDEX idx_kardex_fecha ON kardex(fecha);
</code></pre>

<p><strong>Decisiones clave asociadas:</strong> DEC-2, DEC-9</p>

<hr>

<h2>4. Vista de Desarrollo</h2>

<p>Describe la organizaci√≥n del c√≥digo para soportar mantenibilidad y escalabilidad.</p>

<ul>
  <li>Estructura por dominio (Inventory, POS, Purchases).</li>
  <li>Repositorios independientes por servicio.</li>
  <li>Separaci√≥n clara entre capas: Controller ‚Üí Service ‚Üí Repository.</li>
  <li>Carpeta <code>/events</code> para emisores y listeners.</li>
  <li>Carpeta <code>/cache</code> para l√≥gica de node-cache.</li>
</ul>

<p><strong>Decisiones clave asociadas:</strong> DEC-5, DEC-7</p>

<hr>

<h2>5. Vista F√≠sica</h2>

<p>Representa c√≥mo se despliegan los servicios en el entorno local.</p>

<ul>
  <li><strong>API Gateway</strong>: puerto 3000</li>
  <li><strong>Inventory Service</strong>: puerto 3001 + PostgreSQL 5432</li>
  <li><strong>POS Service</strong>: puerto 3004 + PostgreSQL 5435</li>
  <li><strong>Purchases Service</strong>: puerto 3003 + PostgreSQL 5434</li>
  <li><strong>Socket.IO</strong> integrado en Inventory y POS</li>
</ul>

<p><strong>Decisiones clave asociadas:</strong> DEC-4, DEC-8</p>

<hr>

<h2>6. An√°lisis de Drivers Arquitect√≥nicos</h2>

<h3>QAW-01: Rendimiento (Cache)</h3>

<p><strong>Soporte:</strong></p>
<ul>
  <li>Cache en memoria para cat√°logos y stock.</li>
  <li>Hit rate esperado ‚â• 75%.</li>
  <li>Reducci√≥n significativa de consultas a DB.</li>
</ul>

<p><strong>Decisiones relacionadas:</strong> DEC-3, DEC-9</p>

<hr>

<h3>QAW-02: Disponibilidad (Actualizaci√≥n de Stock en Tiempo Real)</h3>

<p><strong>Soporte:</strong></p>
<ul>
  <li>Socket.IO notifica cambios de stock.</li>
  <li>Latencia esperada &lt; 100ms.</li>
  <li>Alerta de stock bajo inmediatamente.</li>
</ul>

<p><strong>Decisiones relacionadas:</strong> DEC-4, DEC-8</p>

<hr>

<h3>QAW-03: Seguridad (Operaciones Cr√≠ticas de Stock)</h3>

<p><strong>Soporte:</strong></p>
<ul>
  <li>Queries parametrizadas contra SQL injection.</li>
  <li>Validaciones con JOI en payloads.</li>
  <li>Rate limiting en endpoints sensibles.</li>
  <li>Auditor√≠a de movimientos mediante Kardex.</li>
</ul>

<p><strong>Decisiones relacionadas:</strong> DEC-7</p>

<hr>

<h2>7. Evaluaci√≥n de Requisitos Funcionales</h2>

<h3>RF-01: Ventas en POS</h3>
<p><strong>Cumplimiento:</strong> Validaci√≥n previa de stock + registro seguro + evento SaleCompleted.</p>

<h3>RF-02: Control de Inventario</h3>
<p><strong>Cumplimiento:</strong> Kardex, stock actualizado, notificaciones y transacciones ACID.</p>

<h3>RF-03: Kardex Completo</h3>
<p><strong>Cumplimiento:</strong> Modelo inmutable + eventos + trazabilidad completa.</p>

<hr>

<h2>8. Principales Trade-offs</h2>

<h3>Trade-off: Complejidad vs Consistencia</h3>
<p>Aplicar transacciones y bloqueos incrementa complejidad, pero garantiza integridad absoluta del stock.</p>

<h3>Trade-off: Cache vs Freshness</h3>
<p>Cache acelera consultas, pero requiere invalidaci√≥n cuidadosa.</p>

<h3>Trade-off: Event-Driven vs Simplicidad</h3>
<p>Los eventos desacoplan, pero agregan m√°s puntos a monitorear.</p>

<hr>

<h2>9. Conclusi√≥n de la Iteraci√≥n</h2>

<p>
Las decisiones tomadas en esta iteraci√≥n permiten cumplir plenamente los requisitos funcionales y de calidad asociados a la funcionalidad primaria.  
El sistema obtiene:
</p>

<ul>
  <li>Stock consistente y protegido ante concurrencia.</li>
  <li>Kardex confiable como auditor√≠a inmutable.</li>
  <li>Sincronizaci√≥n en tiempo real entre m√≥dulos.</li>
  <li>Rendimiento optimizado mediante cache e √≠ndices.</li>
  <li>Seguridad robusta en operaciones cr√≠ticas.</li>
</ul>

<p>
Estas bases permiten avanzar hacia la Iteraci√≥n 3, enfocada en Reportes, CRM y monitoreo.
</p>


[‚¨ÖÔ∏è Anterior](../9.3.4/9.3.4.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../9.3.6/9.3.6.md)
