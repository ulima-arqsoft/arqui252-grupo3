> [5. T√°cticas](../5.md) ‚Ä∫ [5.1. M√≥dulo 1 / Integrante 1](5.1.md)

# 5.1. M√≥dulo 1 / Integrante 1

---

## Escenario ESC-01: Operabilidad en Registro de Venta R√°pida

### Escenario
| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|:--:|:--|:--|:--|:--|:--|:--|:--|
| **ESC-01** | Operabilidad | Click en "Registrar venta r√°pida" durante feria | Cajero | Formulario de Ventas R√°pidas | Producci√≥n | Confirmaci√≥n de venta y actualizaci√≥n de inventario | Feedback visible en ‚â§ 500 ms |

### T√°ctica Elegida  
**Optimizaci√≥n del flujo POS con Rendering Local y Confirmaci√≥n As√≠ncrona**

### Documentaci√≥n de la Decisi√≥n (ADR)
**T√≠tulo:**  
Elecci√≥n entre Procesamiento S√≠ncrono en Servidor vs Confirmaci√≥n As√≠ncrona Local en Registro de Venta

**Contexto:**  
Durante ferias o temporadas de alta concurrencia, los cajeros deben registrar m√∫ltiples ventas por minuto. La interfaz debe responder instant√°neamente sin esperar confirmaci√≥n completa del servidor para mantener fluidez en la operaci√≥n.

**Alternativas:**
- **Procesamiento s√≠ncrono:** Cada clic espera la respuesta del servidor antes de mostrar confirmaci√≥n. Simple pero lento bajo carga.  
- **Confirmaci√≥n as√≠ncrona local:** Muestra √©xito inmediato y env√≠a la transacci√≥n al backend en segundo plano.  
- **Modo h√≠brido:** Confirma localmente, pero valida con respuesta del servidor antes de cerrar la venta.

**Criterios de Elecci√≥n:**
- Feedback inmediato (‚â§ 500 ms)  
- Integridad de la transacci√≥n  
- Experiencia de usuario fluida  
- Sincronizaci√≥n con inventario  

**Decisi√≥n:**  
Se adopta **confirmaci√≥n as√≠ncrona local** con sincronizaci√≥n posterior del inventario.

**Sustento:**  
La t√°ctica garantiza una interfaz reactiva, reduce tiempos de espera y mantiene la trazabilidad de ventas. Si ocurre una p√©rdida de red, la venta se almacena temporalmente y se sincroniza al restablecer conexi√≥n.

---

## Escenario ESC-02: Consistencia en B√∫squeda de Productos

### Escenario
| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|:--:|:--|:--|:--|:--|:--|:--|:--|
| **ESC-02** | Consistencia | B√∫squeda de producto por nombre o c√≥digo | Usuario | Endpoint de Inventario | Producci√≥n | Resultados coinciden con stock real | 99 % precisi√≥n en 500 b√∫squedas |

### T√°ctica Elegida  
**Consulta Indexada y Sincronizaci√≥n Bidireccional del Inventario**

### Documentaci√≥n de la Decisi√≥n (ADR)
**T√≠tulo:**  
Elecci√≥n entre B√∫squeda en Memoria Cacheada vs Consulta Directa a Base de Datos

**Contexto:**  
El m√≥dulo de ventas r√°pidas depende de una b√∫squeda precisa de productos para evitar errores en precios o disponibilidad. La consistencia entre el inventario real y lo mostrado en el POS es cr√≠tica.

**Alternativas:**
- **Consulta directa al servidor (SQL):** Garantiza precisi√≥n, pero puede ser m√°s lenta.  
- **Copia cacheada local:** M√°s r√°pida, pero puede desactualizarse.  
- **Modelo h√≠brido (cache + verificaci√≥n):** Se consulta cache local y se valida stock con servidor.

**Criterios de Elecci√≥n:**
- Precisi√≥n del 99 %  
- Tiempos de respuesta bajos  
- Sincronizaci√≥n en tiempo real  

**Decisi√≥n:**  
Se adopta un **modelo h√≠brido**: b√∫squeda en cache local con verificaci√≥n peri√≥dica del stock en servidor.

**Sustento:**  
Permite consultas instant√°neas sin sacrificar consistencia, optimizando la experiencia del cajero y garantizando disponibilidad correcta del producto.

---

## Escenario ESC-03: Tolerancia a Errores ante P√©rdida de Conexi√≥n

### Escenario
| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|:--:|:--|:--|:--|:--|:--|:--|:--|
| **ESC-03** | Tolerancia a errores | P√©rdida de conexi√≥n al registrar venta | Sistema | Guardado local + sincronizaci√≥n | Producci√≥n | Notificaci√≥n ‚ÄúGuardado localmente. Sincronizando‚Ä¶‚Äù | 100 % de datos recuperados |

### T√°ctica Elegida  
**Persistencia Local con Sincronizaci√≥n Diferida (Offline-First Pattern)**

### Documentaci√≥n de la Decisi√≥n (ADR)
**T√≠tulo:**  
Estrategia entre Bloqueo de Operaciones vs Modo Offline con Sincronizaci√≥n

**Contexto:**  
Durante ferias o zonas con conexi√≥n inestable, los cajeros deben continuar vendiendo sin interrupci√≥n. Se requiere asegurar que los datos no se pierdan y se sincronicen autom√°ticamente cuando regrese la conexi√≥n.

**Alternativas:**
- **Bloqueo de operaciones:** No permite registrar ventas sin conexi√≥n.  
- **Cola local y sincronizaci√≥n autom√°tica:** Guarda ventas en almacenamiento local y las sincroniza luego.  
- **Registro manual posterior:** Requiere reingresar ventas fallidas.

**Criterios de Elecci√≥n:**
- Continuidad operativa  
- Fiabilidad de datos  
- Recuperaci√≥n 100 % segura  

**Decisi√≥n:**  
Se implementa **cola local persistente (IndexedDB)** con sincronizaci√≥n autom√°tica al reconectarse.

**Sustento:**  
Garantiza que ninguna venta se pierda. Proporciona continuidad y fiabilidad incluso sin internet, cumpliendo con el requisito RF6.

---

## Escenario ESC-05: Eficiencia bajo Alta Carga

### Escenario
| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|:--:|:--|:--|:--|:--|:--|:--|:--|
| **ESC-05** | Eficiencia | 10 ventas simult√°neas registradas | Usuario | Servidor Node.js + PostgreSQL | Producci√≥n | Tiempo promedio de respuesta ‚â§ 1.5 s | 95 % de requests bajo 1.5 s |

### T√°ctica Elegida  
**Escalamiento Horizontal y Pool de Conexiones a Base de Datos**

### Documentaci√≥n de la Decisi√≥n (ADR)
**T√≠tulo:**  
Elecci√≥n entre Escalamiento Vertical y Horizontal para Alta Concurrencia en Punto de Venta

**Contexto:**  
Durante ferias o campa√±as, m√∫ltiples cajeros pueden registrar ventas simult√°neamente. Se requiere mantener el rendimiento estable sin degradaci√≥n de respuesta.

**Alternativas:**
- **Escalamiento vertical:** Aumentar recursos del servidor principal.  
- **Escalamiento horizontal:** Multiplicar instancias Node.js detr√°s de un balanceador.  
- **Cola de procesamiento:** Encolar ventas y procesarlas secuencialmente.

**Criterios de Elecci√≥n:**
- Rendimiento bajo carga  
- Mantenibilidad y costo  
- Escalabilidad futura  

**Decisi√≥n:**  
Se adopta **escalamiento horizontal** con **pool de conexiones PostgreSQL (Sequelize)**.

**Sustento:**  
El balanceo de carga distribuye peticiones de venta en m√∫ltiples instancias y evita saturaci√≥n de CPU. Las conexiones optimizadas garantizan respuesta √°gil y estable.

---

## Escenario ESC-06: Exactitud en C√°lculo de Totales

### Escenario
| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|:--:|:--|:--|:--|:--|:--|:--|:--|
| **ESC-06** | Exactitud | Registro de venta con descuento aplicado | Cajero | PostgreSQL DECIMAL(8,2) | Producci√≥n | Total exacto en columna ‚Äútotal_venta‚Äù | 0 redondeos no autorizados |

### T√°ctica Elegida  
**Uso de Tipos Num√©ricos de Precisi√≥n Fija y Validaciones en Backend**

### Documentaci√≥n de la Decisi√≥n (ADR)
**T√≠tulo:**  
Elecci√≥n entre C√°lculo en Frontend vs Validaci√≥n Num√©rica en Backend

**Contexto:**  
El c√°lculo de subtotales, descuentos, IGV y totales requiere precisi√≥n financiera. Los errores de redondeo pueden afectar reportes e impuestos.

**Alternativas:**
- **C√°lculo en frontend (JavaScript float):** R√°pido, pero propenso a errores binarios.  
- **Validaci√≥n en backend (DECIMAL):** Precisi√≥n garantizada.  
- **C√°lculo mixto:** Front estimado + validaci√≥n backend.

**Criterios de Elecci√≥n:**
- Exactitud decimal  
- Trazabilidad de montos  
- Cumplimiento tributario  

**Decisi√≥n:**  
Se realiza **c√°lculo doble**: previsualizaci√≥n en frontend y validaci√≥n final con **DECIMAL(8,2)** en backend.

**Sustento:**  
Evita inconsistencias visuales y garantiza precisi√≥n financiera compatible con SUNAT, asegurando trazabilidad contable.

---

[üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../5.2/5.2.md)
