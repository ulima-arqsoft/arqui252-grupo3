> [8. Aplicaci√≥n de Patrones Arquitecturales](../../8.md) ‚Ä∫ [8.6. Listado Consolidado](../8.6.md) ‚Ä∫ [8.6.2. Patrones de Componente y Conector](8.6.2.md)

# 8.6.2. Patrones de Componente y Conector

## Patrones de Comunicaci√≥n entre Componentes

Esta secci√≥n documenta c√≥mo los componentes del sistema InnovaLogix interact√∫an entre s√≠, los patrones de comunicaci√≥n aplicados y las tecnolog√≠as utilizadas.

---

## 1. Request-Response (Cliente-Servidor)

**Aplicaci√≥n:**  
Comunicaci√≥n s√≠ncrona entre frontend React y backend Express mediante API REST.

**Componentes involucrados:**
- **Cliente:** Aplicaci√≥n React (navegador)
- **Servidor:** Backend Node.js + Express
- **Protocolo:** HTTP/HTTPS con JSON

**Ejemplos de uso:**
- Frontend solicita lista de productos ‚Üí Backend responde con JSON
- Cajero procesa venta ‚Üí Backend confirma transacci√≥n
- Usuario consulta reporte ‚Üí Backend genera y devuelve datos

**Beneficios:**
- Simplicidad de implementaci√≥n
- Amplio soporte de herramientas
- Facilita debugging con herramientas de red

**Trade-offs:**
- Bloqueo del cliente durante respuesta
- No apto para operaciones de larga duraci√≥n

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de secuencia Request-Response entre React y Express -->

---

## 2. Publish-Subscribe (Event Bus)

**Aplicaci√≥n:**  
Comunicaci√≥n as√≠ncrona entre m√≥dulos mediante eventos de dominio usando EventEmitter de Node.js.

**Componentes involucrados:**
- **Publishers:** M√≥dulos que emiten eventos (SalesService, InventoryService, PurchasesService)
- **Subscribers:** M√≥dulos que escuchan eventos (Observers de cada m√≥dulo)
- **Event Bus:** EventEmitter centralizado

**Eventos principales:**
- `VentaCompletada`: Emitido por Sales, escuchado por Inventory, Reports, CRM
- `StockBajoDetectado`: Emitido por Inventory, escuchado por Purchases
- `OrdenAprobada`: Emitido por Purchases, escuchado por Inventory
- `PuntosActualizados`: Emitido por CRM, escuchado por Notifications

**Beneficios:**
- Desacoplamiento total entre m√≥dulos
- Facilita agregar nuevos subscribers sin modificar publishers
- Procesamiento as√≠ncrono mejora performance

**Trade-offs:**
- Debugging m√°s complejo (flujo no lineal)
- Requiere logging extensivo para trazabilidad
- Consistencia eventual (no inmediata)

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama mostrando Event Bus con m√∫ltiples publishers y subscribers -->

---

## 3. WebSocket (Comunicaci√≥n Bidireccional)

**Aplicaci√≥n:**  
Notificaciones en tiempo real del servidor al cliente usando Socket.IO.

**Casos de uso:**
- Notificar a terminales POS cuando stock se actualiza (evita vender productos agotados)
- Alertas en tiempo real de stock bajo m√≠nimo
- Notificaciones de √≥rdenes de compra aprobadas/rechazadas

**Componentes involucrados:**
- **Servidor WebSocket:** Socket.IO server en backend
- **Clientes:** Interfaces React conectadas v√≠a Socket.IO client
- **Canales:** Rooms por sucursal/terminal

**Beneficios:**
- Actualizaciones instant√°neas sin polling
- Conexi√≥n persistente reduce latencia
- Soporte bidireccional (servidor puede iniciar comunicaci√≥n)

**Trade-offs:**
- Mayor complejidad de implementaci√≥n
- Consumo de recursos del servidor (conexiones persistentes)
- Requiere manejo de reconexi√≥n

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de WebSocket mostrando conexiones persistentes entre server y m√∫ltiples clientes -->

---

## 4. Database Access (Repository Pattern)

**Aplicaci√≥n:**  
Comunicaci√≥n entre capa de servicios y base de datos PostgreSQL mediante Repositories y Sequelize ORM.

**Componentes involucrados:**
- **Services:** L√≥gica de negocio (SalesService, InventoryService)
- **Repositories:** Abstracci√≥n de acceso a datos (SalesRepository, ProductRepository)
- **ORM:** Sequelize mapea objetos JavaScript a tablas PostgreSQL
- **Database:** PostgreSQL 15 en Render

**Patr√≥n de comunicaci√≥n:**
```
Service ‚Üí Repository ‚Üí Sequelize ‚Üí PostgreSQL
```

**Beneficios:**
- Abstracci√≥n de SQL facilita mantenimiento
- Queries parametrizadas previenen SQL injection
- Facilita testing con mocks de repositories

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de capas mostrando flujo Service ‚Üí Repository ‚Üí ORM ‚Üí Database -->

---

## 5. External API Integration (Adapter Pattern)

**Aplicaci√≥n:**  
Integraci√≥n con servicios externos mediante adapters que encapsulan APIs.

**Integraciones externas:**
- **SUNAT API:** Validaci√≥n de RUC, emisi√≥n de comprobantes electr√≥nicos
- **Pasarelas de pago:** Niubiz (tarjetas), Yape, Plin
- **Servicios de notificaci√≥n:** SendGrid (email), Twilio (SMS), WhatsApp Business API

**Patr√≥n Adapter:**
- Cada API externa tiene su adapter (SunatAdapter, NiubizAdapter, SendGridAdapter)
- Adapters traducen de interfaz interna a API externa
- Facilita cambiar proveedor sin afectar l√≥gica de negocio

**Beneficios:**
- Aislamiento de cambios en APIs externas
- Testing con mocks de adapters
- Centralizaci√≥n de autenticaci√≥n y manejo de errores

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama mostrando Services usando Adapters para comunicarse con APIs externas -->

---

## Resumen de Conectores

| Tipo de Comunicaci√≥n | Tecnolog√≠a | Uso Principal | Sincr√≥nico/As√≠nc |
|----------------------|-------------|---------------|---------------------|
| Request-Response | HTTP REST + JSON | Frontend-Backend | S√≠ncrono |
| Publish-Subscribe | EventEmitter (Node.js) | Comunicaci√≥n entre m√≥dulos | As√≠ncrono |
| WebSocket | Socket.IO | Notificaciones tiempo real | Bidireccional |
| Database Access | Sequelize ORM + PostgreSQL | Persistencia de datos | S√≠ncrono |
| External APIs | HTTP REST + Adapters | Servicios externos | S√≠ncrono |

---

[‚¨ÖÔ∏è Anterior](../8.6.1/8.6.1.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../8.6.3/8.6.3.md)