> [8. Aplicaci√≥n de Patrones Arquitecturales](../8.md) ‚Ä∫ [8.1. M√≥dulo 1 / Integrante 1](8.1.md)

# 8.1. Patrones del M√≥dulo POS (Ventas R√°pidas)

## **Decisi√≥n 1: Patr√≥n MVC**

**T√≠tulo:**  
Separaci√≥n de responsabilidades en el m√≥dulo de punto de venta mediante MVC

**Contexto:**  
El m√≥dulo POS de InnovaLogix maneja operaciones cr√≠ticas de ventas en tiempo real: registro de productos, c√°lculo de totales con descuentos, procesamiento de m√∫ltiples m√©todos de pago (efectivo, tarjeta, Yape, Plin), y generaci√≥n de comprobantes. Se requiere una arquitectura que separe la l√≥gica de presentaci√≥n del cajero, los c√°lculos de negocio y el acceso a datos.

**Alternativas:**
1. **Arquitectura sin separaci√≥n:**
   - Toda la l√≥gica mezclada en componentes React
   - Desarrollo inicial r√°pido
   - Dificulta testing y mantenimiento
   - Alto acoplamiento entre UI y l√≥gica de negocio

2. **Patr√≥n MVC:**
   - Separaci√≥n clara: Model (entidades), View (interfaz React), Controller (endpoints backend)
   - Facilita testing independiente de cada capa
   - Permite reutilizar servicios desde m√∫ltiples puntos
   - Familiaridad del equipo con el patr√≥n

3. **Arquitectura Hexagonal:**
   - Mayor aislamiento de la l√≥gica de dominio
   - Complejidad adicional para el alcance actual
   - Curva de aprendizaje m√°s pronunciada

**Criterios de elecci√≥n:**
- **Mantenibilidad:** Facilidad para modificar sin afectar otras capas
- **Testabilidad:** Pruebas unitarias de l√≥gica de negocio aislada
- **Familiaridad:** Conocimiento del equipo con el patr√≥n
- **Tiempo de desarrollo:** Balance entre estructura y velocidad

**Decisi√≥n:**
Patr√≥n Model-View-Controller (MVC).

- **Model:** Entidades (Venta, DetalleVenta, Producto, Cliente) gestionadas con Sequelize ORM
- **View:** Componentes React para interfaz del cajero (b√∫squeda de productos, carrito, procesamiento de pago)
- **Controller:** Endpoints REST en Express que orquestan servicios de ventas, validaciones y actualizaci√≥n de inventario

**Sustento:**  
MVC proporciona la estructura necesaria para el m√≥dulo POS sin agregar complejidad innecesaria. La separaci√≥n permite que cambios en la interfaz del cajero no afecten la l√≥gica de c√°lculos de descuentos o procesamiento de pagos. Los controladores backend pueden testearse independientemente, y los servicios son reutilizables desde futuras aplicaciones m√≥viles. Cumple con QAW-05 (agregar m√©todos de pago en menos de 8 horas) al mantener la l√≥gica de pagos aislada en servicios espec√≠ficos.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama MVC mostrando flujo desde interfaz React del cajero hacia controladores Express y modelos Sequelize -->

---

## **Decisi√≥n 2: Patr√≥n Strategy**

**T√≠tulo:**  
Gesti√≥n flexible de m√©todos de pago mediante Strategy

**Contexto:**  
InnovaLogix acepta m√∫ltiples m√©todos de pago con l√≥gicas diferentes: efectivo requiere calcular cambio, tarjetas necesitan validaci√≥n de terminal POS, pagos digitales (Yape/Plin) requieren confirmaci√≥n de transacci√≥n. El sistema debe permitir agregar nuevos m√©todos sin modificar c√≥digo existente.

**Alternativas:**
1. **Condicionales if/switch:**
   - Toda la l√≥gica centralizada con condicionales
   - Cada nuevo m√©todo requiere modificar c√≥digo existente
   - Dificulta testing individual de cada m√©todo
   - Viola principio Open/Closed

2. **Patr√≥n Strategy:**
   - Cada m√©todo de pago es una estrategia independiente
   - Interfaz com√∫n (procesarPago)
   - Extensible sin modificar c√≥digo existente
   - Testing aislado por estrategia

3. **Chain of Responsibility:**
   - Cadena de handlers
   - √ötil para validaciones secuenciales
   - Sobrecarga para este caso

**Criterios de elecci√≥n:**
- **Extensibilidad:** Agregar m√©todos sin modificar c√≥digo
- **Principio Open/Closed:** Extensi√≥n sin modificaci√≥n
- **Testabilidad:** Pruebas unitarias por m√©todo
- **Mantenibilidad:** Aislamiento de cada l√≥gica

**Decisi√≥n:**
Patr√≥n Strategy.

- **Interfaz:** PaymentStrategy con m√©todo procesarPago(monto, detalles)
- **Estrategias concretas:** EfectivoStrategy, TarjetaStrategy, YapeStrategy, PlinStrategy
- **Contexto:** SalesService selecciona estrategia seg√∫n m√©todo elegido

**Sustento:**  
Strategy permite que cada m√©todo de pago tenga su l√≥gica encapsulada: EfectivoStrategy calcula cambio, TarjetaStrategy valida cuotas y conexi√≥n con terminal, YapeStrategy/PlinStrategy confirman transacciones digitales. Agregar futuros m√©todos (criptomonedas, billeteras digitales) requiere solo crear una nueva clase sin tocar SalesService. Cumple directamente con QAW-05 de mantenibilidad.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de clases Strategy mostrando PaymentStrategy y sus implementaciones concretas -->

---

## **Decisi√≥n 3: Patr√≥n PWA Offline-First**

**T√≠tulo:**  
Disponibilidad continua del POS mediante Progressive Web App

**Contexto:**  
InnovaLogix opera en tienda f√≠sica donde pueden ocurrir cortes temporales de Internet. Los cajeros deben continuar registrando ventas durante interrupciones, con sincronizaci√≥n autom√°tica al recuperar conexi√≥n. QAW-01 requiere 99% de disponibilidad.

**Alternativas:**
1. **Aplicaci√≥n 100% online:**
   - Requiere conexi√≥n permanente
   - Imposibilidad de operar durante cortes
   - No cumple requisito de disponibilidad

2. **Progressive Web App (Offline-First):**
   - Service Workers cachean recursos
   - IndexedDB almacena ventas pendientes
   - Sincronizaci√≥n autom√°tica al recuperar conexi√≥n
   - Experiencia continua para el cajero

3. **Aplicaci√≥n nativa m√≥vil:**
   - Mejor soporte offline
   - Requiere desarrollo iOS + Android
   - Mayor costo y tiempo
   - M√∫ltiples codebases

**Criterios de elecci√≥n:**
- **Disponibilidad:** Operaci√≥n sin conexi√≥n
- **Sincronizaci√≥n:** Confiabilidad en replicaci√≥n
- **Experiencia de usuario:** Continuidad sin interrupciones
- **Costo:** Aprovechamiento de c√≥digo web existente

**Decisi√≥n:**
Progressive Web App con estrategia Offline-First.

- **Service Workers:** Cacheo de assets est√°ticos (JS, CSS, im√°genes)
- **IndexedDB:** Almacenamiento local de ventas pendientes
- **Background Sync:** Env√≠o autom√°tico al recuperar conexi√≥n
- **Indicadores visuales:** Notificaci√≥n de estado de conexi√≥n

**Sustento:**  
PWA cumple con el requisito de disponibilidad del 99% (QAW-01) permitiendo que el POS funcione completamente durante cortes de Internet. Las ventas se almacenan en IndexedDB del navegador y se sincronizan autom√°ticamente cuando la conexi√≥n regresa. El cajero no experimenta interrupciones visibles, manteniendo la productividad. Aprovecha el c√≥digo React existente sin requerir desarrollo nativo adicional, y Vercel (plataforma de despliegue) soporta PWA nativamente.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de flujo mostrando operaci√≥n del POS con y sin conexi√≥n, almacenamiento en IndexedDB y sincronizaci√≥n posterior -->

---

[üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../8.2/8.2.md)