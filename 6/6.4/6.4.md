> [6. Documentaci√≥n de Arquitectura (Bosquejo)](../6.md) ‚Ä∫ [6.4. Otras Vistas](6.4.md)

# 6.4. Otras Vistas

## Vistas Adicionales de Arquitectura - InnovaLogix Retail ERP

Esta secci√≥n presenta vistas arquitect√≥nicas complementarias que ayudan a comprender aspectos espec√≠ficos del sistema InnovaLogix Retail ERP.

### Vista de Despliegue

La vista de despliegue muestra c√≥mo los componentes del sistema se distribuyen en la infraestructura f√≠sica/cloud.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de despliegue mostrando Frontend (Vercel), Backend (Render), Base de Datos (PostgreSQL en Render), y conexiones entre ellos. Incluir zonas de disponibilidad y CDN para activos est√°ticos. -->

**Nodos de Despliegue:**

1. **Nodo Frontend (Vercel):**
   - Aplicaci√≥n React compilada (SPA)
   - CDN global para activos est√°ticos
   - SSL/TLS autom√°tico
   - Edge Network para baja latencia
   - Build autom√°tico desde Git

2. **Nodo Backend (Render):**
   - Servidor Node.js + Express
   - Instancia: 512MB RAM, 0.1 CPU
   - Auto-scaling disponible
   - Health checks cada 30 segundos
   - SSL/TLS incluido
   - Logs centralizados

3. **Nodo Base de Datos (Render PostgreSQL):**
   - PostgreSQL 15
   - 256MB RAM, almacenamiento SSD
   - Backups diarios autom√°ticos
   - Conexiones cifradas (SSL)
   - R√©plicas de lectura opcionales

**Comunicaci√≥n:**
- Frontend ‚Üí Backend: HTTPS/REST (puerto 443)
- Backend ‚Üí PostgreSQL: TCP/5432 (conexi√≥n cifrada)
- Backend ‚Üí EventBus: In-process (Node EventEmitter)

### Vista de Datos

La vista de datos muestra el modelo de dominio y las principales entidades del sistema.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama entidad-relaci√≥n (ERD) mostrando las tablas principales: usuarios, roles, ventas, detalle_venta, productos, variantes, stock, ubicaciones, kardex, compras, proveedores, clientes, puntos, reclamos, encuestas. Incluir relaciones y cardinalidades. -->

**Entidades Principales:**

**M√≥dulo de Ventas:**
- `ventas` (id, fecha, total, tipo_comprobante, usuario_id)
- `detalle_venta` (id, venta_id, producto_id, cantidad, precio, subtotal)
- `comprobantes` (id, venta_id, tipo, serie, numero, xml, pdf)
- `pagos` (id, venta_id, metodo, monto)

**M√≥dulo de Inventario:**
- `productos` (id, nombre, descripcion, categoria, marca)
- `variantes` (id, producto_id, talla, color, sku)
- `stock` (id, variante_id, ubicacion_id, cantidad, stock_minimo)
- `ubicaciones` (id, nombre, tipo, zona)
- `kardex` (id, producto_id, tipo_movimiento, cantidad, fecha, referencia)
- `precios_temporada` (id, variante_id, temporada, precio_base, descuento)

**M√≥dulo de Compras:**
- `compras` (id, proveedor_id, fecha, total, estado)
- `detalle_compra` (id, compra_id, producto_id, cantidad, precio_unitario)
- `proveedores` (id, razon_social, ruc, contacto, email, telefono)
- `historial_precios` (id, proveedor_id, producto_id, precio, fecha)

**M√≥dulo de CRM:**
- `clientes` (id, nombre, email, telefono, documento, fecha_registro)
- `puntos` (id, cliente_id, puntos_acumulados, puntos_canjeados)
- `reclamos` (id, cliente_id, venta_id, tipo, descripcion, estado, fecha)
- `encuestas` (id, cliente_id, tipo, respuestas, puntuacion, fecha)
- `interacciones` (id, cliente_id, tipo, canal, descripcion, fecha)

**Entidades Transversales:**
- `usuarios` (id, nombre, email, password_hash, rol_id, activo)
- `roles` (id, nombre, permisos)
- `auditoria` (id, entidad, operacion, usuario_id, cambios, timestamp)

### Vista de Seguridad

La vista de seguridad detalla los mecanismos de protecci√≥n del sistema.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de seguridad mostrando capas de protecci√≥n: autenticaci√≥n JWT, autorizaci√≥n RBAC, cifrado de datos, validaci√≥n de entrada, protecci√≥n CSRF/XSS, y logs de auditor√≠a. -->

**Capas de Seguridad:**

1. **Autenticaci√≥n:**
   - JWT (JSON Web Tokens) sin estado
   - Tokens con expiraci√≥n de 8 horas
   - Refresh tokens con expiraci√≥n de 7 d√≠as
   - Hash de contrase√±as con bcrypt (salt rounds: 10)
   - Bloqueo de cuenta tras 5 intentos fallidos

2. **Autorizaci√≥n:**
   - RBAC (Role-Based Access Control)
   - Roles: Admin, Gerente, Cajero, Almacenero, Vendedor
   - Permisos granulares por endpoint
   - Middleware de validaci√≥n en cada ruta protegida

3. **Protecci√≥n de Datos:**
   - Cifrado en tr√°nsito: TLS 1.3
   - Cifrado en reposo: PostgreSQL encryption
   - Datos sensibles hasheados (contrase√±as, tokens)
   - PII protegida (datos personales de clientes)

4. **Validaci√≥n y Sanitizaci√≥n:**
   - Validaci√≥n de entrada con Joi schemas
   - Sanitizaci√≥n contra SQL Injection (Sequelize ORM)
   - Protecci√≥n XSS (escape de HTML)
   - Protecci√≥n CSRF (tokens en formularios)
   - Rate limiting (max 100 req/min por IP)

5. **Auditor√≠a:**
   - Logs de todas las operaciones cr√≠ticas
   - Registro de accesos y cambios
   - Timestamps de todas las transacciones
   - Trazabilidad completa de modificaciones

### Vista de Rendimiento

La vista de rendimiento muestra estrategias de optimizaci√≥n.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de rendimiento mostrando uso de cach√©, √≠ndices de base de datos, paginaci√≥n, lazy loading, optimizaci√≥n de queries, y m√©tricas de performance. -->

**Estrategias de Optimizaci√≥n:**

1. **Cach√©:**
   - Cach√© de consultas frecuentes (productos, precios)
   - TTL (Time To Live): 15 minutos
   - Invalidaci√≥n por eventos de dominio
   - Cach√© de sesiones en memoria

2. **Base de Datos:**
   - √çndices en columnas frecuentemente consultadas
   - √çndices compuestos para queries complejas
   - Particionamiento de tabla `kardex` por fecha
   - Vistas materializadas para reportes

3. **API:**
   - Paginaci√≥n en todos los listados (20 items/p√°gina)
   - Filtrado y ordenamiento en backend
   - Compresi√≥n gzip de respuestas JSON
   - ETags para cach√© de recursos

4. **Frontend:**
   - Code splitting por m√≥dulo
   - Lazy loading de componentes
   - Memoizaci√≥n de c√°lculos pesados
   - Virtual scrolling en listas grandes
   - Service Worker para cach√© offline

5. **Monitoreo:**
   - M√©tricas de tiempo de respuesta
   - Tracking de queries lentas (>1s)
   - Alertas de errores 5xx
   - Dashboard de salud del sistema

### Vista de Integraci√≥n

La vista de integraci√≥n muestra las conexiones externas del sistema.

<!-- INSERTAR IMAGEN ACERCA DE: Diagrama de integraci√≥n mostrando conexiones con sistemas externos: API SUNAT (facturaci√≥n electr√≥nica), pasarelas de pago, servicios de email, APIs de proveedores, y posibles integraciones futuras. -->

**Integraciones Actuales:**

1. **SUNAT (facturaci√≥n electr√≥nica):**
   - Env√≠o de comprobantes XML
   - Validaci√≥n de RUC/DNI
   - Consulta de estado de comprobantes

2. **EmailJS:**
   - Env√≠o de encuestas de satisfacci√≥n
   - Notificaciones de reclamos
   - Alertas de stock bajo

**Integraciones Futuras:**

1. **Pasarelas de Pago:**
   - Integraci√≥n con Mercado Pago
   - Integraci√≥n con Culqi
   - Procesamiento PCI-compliant

2. **APIs de Proveedores:**
   - Sincronizaci√≥n de cat√°logos
   - Actualizaci√≥n autom√°tica de precios
   - Tracking de √≥rdenes de compra

3. **Business Intelligence:**
   - Conexi√≥n con Power BI
   - Exportaci√≥n a Data Warehouse
   - An√°lisis predictivo

---

[‚¨ÖÔ∏è Anterior](../6.3/6.3.md) | [üè† Home](../../README.md)